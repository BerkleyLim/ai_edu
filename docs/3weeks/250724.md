# 18μΌμ°¨ - 250724


# π“ Clustering

- **Clustering**μ€ **λΌλ²¨μ΄ μ—†λ” λ°μ΄ν„°(unlabeled data)** λ¥Ό λ‹¤λ£¨λ” **λΉ„μ§€λ„ ν•™μµ(unsupervised learning)** λ°©λ²•μ΄λ‹¤.
- λ°μ΄ν„°λ¥Ό μ μ‚¬ν• νΉμ„±μ„ κ°€μ§„ κ·Έλ£ΉμΌλ΅ λ¶„ν• ν•λ‹¤.
  - **Intra-class similarity**λ” λ†’κ³ , **Inter-class similarity**λ” λ‚®λ‹¤.
- μ‚¬μ©λλ” **distance measure** (κ±°λ¦¬ μΈ΅μ • λ°©μ‹)μ— λ”°λΌ ν΄λ¬μ¤ν„°λ§ κ²°κ³Όκ°€ λ‹¬λΌμ§„λ‹¤.


## π§  Clusteringμ λ€ν‘ μ‘μ©

- **Image Segmentation**
- **Targeted Marketing**
- **SDD Image Clustering**
- **Community Detection in Social Media**


# π“ k-Means Clustering

## π― λ©ν‘

- λ°μ΄ν„° $\{x_n \in \mathbb{R}^D \mid n = 1, \dots, N\}$ λ¥Ό $K$κ°μ ν΄λ¬μ¤ν„° $C_k$ λ΅ λ¶„ν• .
- κ° ν΄λ¬μ¤ν„° μ¤‘μ‹¬ λ²΅ν„° $\mu_k$ λ” λ‹¤μκ³Ό κ°™μ΄ μ •μλ¨:

$$
\mu_k = \frac{1}{N_k} \sum_{n \in C_k} x_n
$$

- λ©μ  ν•¨μ $J$λ” κ° ν¬μΈνΈμ™€ ν΄λ¬μ¤ν„° μ¤‘μ‹¬ κ°„μ μ ν΄λ¦¬λ“ κ±°λ¦¬μ μ κ³±ν•©:

$$
J = \sum_{k=1}^{K} \sum_{n \in C_k} \| x_n - \mu_k \|^2
$$


## π§Ύ μ•κ³ λ¦¬μ¦ (k-means)

1. **Assignment Step**: λ¨λ“  ν¬μΈνΈλ¥Ό κ°€μ¥ κ°€κΉμ΄ ν΄λ¬μ¤ν„°μ— ν• λ‹Ή

   $$\arg \min_k \|x_n - \mu_k\|^2$$

2. **Update Step**: κ° ν΄λ¬μ¤ν„°μ μ¤‘μ‹¬ $\mu_k$λ¥Ό λ‹¤μ‹ κ³„μ‚°

   $$
   \mu_k^{\text{new}} = \frac{1}{N_k} \sum_{n \in C_k} x_n
   $$


## β™οΈ Alternative Formulation

- Cluster indicator λ³€μ $r_{k,n}$ μ‚¬μ©:

$$
r_{k,n} =
\begin{cases}
1, & \text{if } \arg \min_j \|x_n - \mu_j\|^2 = k \\
0, & \text{otherwise}
\end{cases}
$$

- μ—…λ°μ΄νΈ μ‹:

$$
\mu_k = \frac{\sum_{n=1}^{N} r_{k,n} x_n}{\sum_{n=1}^{N} r_{k,n}}
$$


## π§® Mixed-Integer OptimizationμΌλ΅μ ν•΄μ„

$$
\arg\min J = \sum_{k=1}^{K} \sum_{n=1}^{N} r_{k,n} \|x_n - \mu_k\|^2
$$

subject to

$$
R = [r_{k,n}] \in \left\{ R \in \{0, 1\}^{K \times N} \mid \sum_{k=1}^{K} r_{k,n} = 1 \right\}
$$


## β οΈ k-meansμ ν•κ³„

- μ΄κΈ° μ¤‘μ‹¬κ°’μ— λ―Όκ°
- **Convex** ν•νƒμ ν΄λ¬μ¤ν„°μ—λ§ μ ν•©
- μ μ ν• $k$ κ°’μ„ κ³ λ¥΄λ” κΈ°μ¤€μ΄ μ—†μ


## π’΅ Elbow Method

- WCSS (Within-Cluster-Sum-of-Squares) κΈ°λ°μΌλ΅ $k$ κ°’ κ²°μ •
- κ·Έλν”„μ—μ„ "ν”κΏμΉ(elbow)" λ¨μ–‘μ΄ μƒκΈ°λ” μ§€μ μ„ μµμ  $k$λ΅ μ„ νƒ

---

# Mixture of Gaussians (MoG)

MoGλ” λ°μ΄ν„°λ¥Ό μ—¬λ¬ κ°μ κ°€μ°μ‹μ• λ¶„ν¬λ΅ κµ¬μ„±λ νΌν•© λ¨λΈλ΅ ν‘ν„ν•©λ‹λ‹¤. ν™•λ¥  κΈ°λ° μ ‘κ·Όμ„ μ‚¬μ©ν•©λ‹λ‹¤.

## k-Meansμ™€ λΉ„κµ
| ν•­λ© | k-Means | MoG |
|------|---------|-----|
| ν™•λ¥  κΈ°λ° | μ•„λ‹μ¤ | μ |
| μ μ—°μ„± | λ‚®μ | λ†’μ |
| ν™•μ¥μ„± | λ†’μ | λ‚®μ |

## κ°λ…
- κ° λ°μ΄ν„°λ” μ—¬λ¬ κ°μ κ°€μ°μ‹μ• μ¤‘ ν•λ‚μ—μ„ μƒμ„±λ¨
- `Ο€_k`: κ°€μ°μ‹μ• kμ— μ†ν•  ν™•λ¥  (mixing coefficient)
- `ΞΌ_k`, `Ξ£_k`: κ° κ°€μ°μ‹μ•μ ν‰κ· κ³Ό κ³µλ¶„μ‚°

## μμ‹ μ”μ•½
- μ „μ²΄ ν™•λ¥ :  
  `p(x) = Ξ£_k Ο€_k N(x | ΞΌ_k, Ξ£_k)`
- μµλ€μ°λ„ μ¶”μ •(MLE)λ΅ νλΌλ―Έν„° μ—…λ°μ΄νΈ

## μ•κ³ λ¦¬μ¦ (EM)
1. **E-step**: κ° λ°μ΄ν„°κ°€ μ–΄λ–¤ κ°€μ°μ‹μ•μ— μ†ν•  ν™•λ¥  κ³„μ‚°
2. **M-step**: κ° κ°€μ°μ‹μ•μ νλΌλ―Έν„°(ΞΌ, Ξ£, Ο€) μ—…λ°μ΄νΈ

## μμ‹
- κ°€μ°μ‹μ• μλ¥Ό λλ¦΄μλ΅ λ¶„ν¬λ¥Ό λ” μ •λ°€ν•κ² λ¨λΈλ§
- `Οƒ^2 β†’ 0`μΌ λ• k-meansμ™€ λ™μΌν• ν•νƒλ΅ μλ ΄

## ν΄λ¬μ¤ν„° μ κ²°μ • λ°©λ²•
- AIC, BIC (μ •λ³΄ κΈ°μ¤€) μ‚¬μ©
- Elbow method: ν΄λ¬μ¤ν„° μμ— λ”°λ¥Έ λΉ„μ© ν•¨μ ν™•μΈ

---

# π€ DBSCAN (Density-Based Spatial Clustering of Applications with Noise)

- **λ°€λ„ κΈ°λ° ν΄λ¬μ¤ν„°λ§** μ•κ³ λ¦¬μ¦
- λ°€λ„κ°€ λ†’μ€ μμ—­μ€ ν΄λ¬μ¤ν„°λ΅ κ°„μ£Ό, λ°€λ„κ°€ λ‚®μ€ μμ—­μ€ λ…Έμ΄μ¦λ΅ κ°„μ£Ό


## π“ μ£Όμ” κ°λ…

- **eps (Ξµ)**: μ λ“¤ κ°„μ— μ΄ κ±°λ¦¬ μ΄λ‚΄μ— μμΌλ©΄ 'μ΄μ›ƒ'μΌλ΅ κ°„μ£Ό
- **min_samples**: ν•µμ‹¬ ν¬μΈνΈ(core point)κ°€ λκΈ° μ„ν• μµμ† μ΄μ›ƒ κ°μ
- **core point**: Ξµ λ°κ²½ λ‚΄μ— μ΄μ›ƒμ΄ min_samples μ΄μƒμΈ μ 
- **border point**: core pointμ μ΄μ›ƒμ΄μ§€λ§ μμ‹ μ€ core pointκ°€ μ•„λ‹ μ 
- **noise point**: μ–΄λ ν΄λ¬μ¤ν„°μ—λ„ μ†ν•μ§€ μ•λ” μ΄μƒμΉ


## π ν¬μΈνΈ μ ν•

1. **Core Point**: $\varepsilon$ λ‚΄μ— min_samples μ΄μƒμ ν¬μΈνΈκ°€ μμ
2. **Border Point**: $\varepsilon$ λ‚΄μ— μμ§€λ§ min_samples λ―Έλ§μ΄κ³ , core pointμ μ΄μ›ƒ
3. **Noise Point**: μ„ λ‘ μ΅°κ±΄μ— ν•΄λ‹Ήν•μ§€ μ•μ (ν΄λ¬μ¤ν„° λΌλ²¨ -1)


## β›“οΈ DBSCAN μ•κ³ λ¦¬μ¦ μμ„

1. μ½”μ–΄ ν¬μΈνΈλ¥Ό μ„μλ΅ μ„ νƒν•μ—¬ ν΄λ¬μ¤ν„° μ‹μ‘
2. μ΄μ›ƒ ν¬μΈνΈλ¥Ό λ¨λ‘ ν΄λ¬μ¤ν„°μ— ν¬ν•¨
3. ν™•μ¥ν•  μ μ—†μΌλ©΄ λ‹¤λ¥Έ μ½”μ–΄ ν¬μΈνΈλ΅ μƒ ν΄λ¬μ¤ν„° μƒμ„±
4. λ°λ³µ


## π“ Two Moons Dataset

- k-meansλ” λ‘ κ°μ λ°λ‹¬ λ¨μ–‘μ„ λ‚λ„κΈ° μ–΄λ µμ§€λ§
- DBSCANμ€ λ³µμ΅ν• ν•νƒμ ν΄λ¬μ¤ν„°λ„ μ νƒμ§€

## ν΄λ¬μ¤ν„°λ§ κ³Όμ •
1. μ„μμ μ μ—μ„ μ‹μ‘ν•μ—¬ core pointμΈμ§€ ν™•μΈ
2. core pointμ΄λ©΄ ν•΄λ‹Ή μ μ„ κΈ°μ¤€μΌλ΅ μ—°κ²°λ μ΄μ›ƒμ„ ν•λ‚μ ν΄λ¬μ¤ν„°λ΅ ν™•μ¥
3. border pointλ” core pointμ— μ†ν•μ§€λ§ ν΄λ¬μ¤ν„° ν™•μ¥μ—λ” μ‚¬μ©λμ§€ μ•μ
4. λ°λ³µν•μ—¬ λ¨λ“  μ μ„ λ°©λ¬Έ

## μ¥μ 
- ν΄λ¬μ¤ν„° κ°μλ¥Ό λ―Έλ¦¬ μ• ν•„μ” μ—†μ
- μ΄μƒμΉ(outlier) μλ™ νƒμ§€
- λ³µμ΅ν• λ¨μ–‘μ ν΄λ¬μ¤ν„°μ—λ„ κ°•ν•¨

## μμ‹
- λ‹¬ λ¨μ–‘ λ°μ΄ν„°(two moons)λ„ ν¨κ³Όμ μΌλ΅ κµ¬λ¶„
- Iris λ°μ΄ν„°μ—μ„λ” `eps`, `min_samples`μ— λ”°λΌ κ²°κ³Όκ°€ λ‹¤λ¦„


## π“ Iris λ°μ΄ν„° μμ‹

```python
from sklearn.cluster import DBSCAN
dbscan = DBSCAN(eps=0.4, min_samples=10)
dbscan.fit(df[['sepal_length', 'sepal_width']])
```

- λ‘ κ°μ outlier (-1 λΌλ²¨) μ΅΄μ¬
- μ μ ν• νλΌλ―Έν„° μ΅°μ •μΌλ΅ λ…Έμ΄μ¦μ™€ ν΄λ¬μ¤ν„°λ¥Ό μ λ¶„λ¦¬ κ°€λ¥


